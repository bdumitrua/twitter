## Структура модулей

Каждый модуль проекта содержит следующие папки:

### Consumers (Консьюмеры)

**Задача:** Выполнение фоновых задач на основе новых сообщений в топиках Kafka.
**Использование:** Для каждого топика может быть создан консьюмер, который будет прослушивать этот топик и выполнять определенную логику фоново при появлении новых сообщений.

### Controllers (Контроллеры)

**Задача:** Обработка входящих HTTP-запросов, валидация входных данных и отправка ответов.
**Использование:** Каждый контроллер ассоциируется с определенным роутом и типом запроса, обращается к сервисам для выполнения бизнес-логики и возвращает структурированный ответ.

### DTO (ДТО-шки)

**Задача:** Создание объектов для передачи данных между разными частями программы.
**Использование:** В основном используются для сбора данных перед отправкой в репозиторий или для передачи данных в сервисы, если вызов сервиса не происходит через контроллер.

### Events (События)

**Задача:** Запуск определенных процессов при возникновении события.
**Использование:** События используются для отправки уведомлений о происходящих событиях в системе, что в свою очередь инициирует связанную логику.

### Listeners (Слушатели Событий)

**Задача:** Реакция на определенные события в системе и выполнение соответствующих действий.
**Использование:** Слушатели активируются при возникновении события и выполняют задачи, такие как обработка данных или взаимодействие с другими компонентами системы.

### Models (Модели)

**Задача:** Представление и взаимодействие с данными в базе данных.
**Использование:** Модели используются для определения структуры данных, связей между таблицами и запросов к базе данных через Eloquent ORM.

### Repositories (Репозитории)

**Задача:** Инкапсуляция логики запросов к базе данных.
**Использование:** Отделяют логику запросов от бизнес-логики в сервисах, облегчают переиспользование логики работы с данными.

### Requests (Реквесты)

**Задача:** Автоматическая валидация данных, отправленных в HTTP запросах.
**Использование:** Под каждый энд-поинт создается специальный реквест с правилами валидации, используемый в соответствующем контроллере.

### Resources (Ресурсы)

**Задача:** Компановка данных перед отправкой ответа.
**Использование:** Используются в сервисах перед возвратом данных в контроллер, формируют JSON ответ и содержат дополнительную логику.

### Routes (Роуты)

**Задача:** Создание энд-поинтов для взаимодействия с бэкендом через HTTP запросы.
**Использование:** Для каждого контроллера создается отдельный файл роутов, которые подключаются в RouteServiceProvider.

### Services (Сервисы)

**Задача:** Выполнение основной бизнес-логики приложения.
**Использование:** Принимают данные от контроллеров, обрабатывают их и возвращают результат обратно в контроллеры.

## Общие правила: (Coming soon)

## Команды и скрипты

Проект включает в себя ряд полезных команд и скриптов, облегчающих разработку и управление проектом.

### Команды Artisan

- **Создание нового модуля**
  - `php artisan make:module {name}`
  - **Описание**: Создает новый модуль с базовым набором файлов. Имя модуля задается параметром `{name}`.

- **Обновление базы данных**
  - `php artisan db:refresh`
  - **Описание**: Очищает данные из Firebase bucket, удаляет все данные локальной базы данных, заново выполняет все миграции и сидеры. Возвращает JWT для авторизации от первого пользователя (для удобства). Также очищает кэш в Redis.

### Скрипты

- **Очистка данных Kafka**
  - `clearKafka.sh`
  - **Описание**: Удаляет все данные из топиков Kafka, очищая их.

- **Очистка логов Supervisor**
  - `clearSVLogs.sh`
  - **Описание**: Удаляет все логи консьюмеров, отслеживаемые через Supervisor.

- **Запуск в Docker**
  - `start.sh`
  - **Описание**: Используется при запуске контейнера бэкенда в Docker, инициируя необходимые процессы для работы приложения.


## Модели

Каждая модель в проекте соответствует определенной таблице в базе данных:

- **AuthRegistration**
  - **Таблица:** `auth_registrations`
  - **Назначение:** Хранение данных регистрации пользователей.

- **AuthReset**
  - **Таблица:** `auth_resets`
  - **Назначение:** Управление сбросом пароля аккаунта.

- **Chat**
  - **Таблица:** `chats`
  - **Назначение:** Хранение списка участников чата.

- **ChatMessage**
  - **Таблица:** `сhat_messages`
  - **Назначение:** Связь чат-сообщение для поиска чата по сообщению.

- **HiddenChat**
  - **Таблица:** `hidden_chats`
  - **Назначение:** Скрытие ненужных чатов от пользователя.

- **DeviceToken**
  - **Таблица:** `device_tokens`
  - **Назначение:** Управление девайс токенами для уведомлений.

- **NotificationsSubscribtion**
  - **Таблица:** `notifications_subscribtions`
  - **Назначение:** Подписка на твиты других пользователей.

- **UserNotification**
  - **Таблица:** `user_notifications`
  - **Назначение:** Сохранение уведомлений для пользователя.

- **RecentSearch**
  - **Таблица:** `recent_searches`
  - **Назначение:** Управление недавним поиском пользователей.

- **Tweet**
  - **Таблица:** `tweets`
  - **Назначение:** Управление данными твитов.

- **TweetDraft**
  - **Таблица:** `tweet_drafts`
  - **Назначение:** Управление черновиками твитов.

- **TweetFavorite**
  - **Таблица:** `tweet_favorites`
  - **Назначение:** Управление избранными твитами.

- **TweetLike**
  - **Таблица:** `tweet_likes`
  - **Назначение:** Управление лайками твитов.

- **TweetNotice**
  - **Таблица:** `tweet_notices`
  - **Назначение:** Управление упоминаниями в твитах.

- **User**
  - **Таблица:** `users`
  - **Назначение:** Управление данными пользователей и аутентификацией.

- **UserGroup**
  - **Таблица:** `user_group`
  - **Назначение:** Управление личными группами пользователей.

- **UserGroupMember**
  - **Таблица:** `user_group_members`
  - **Назначение:** Хранение участников группы.

- **UsersList**
  - **Таблица:** `users_lists`
  - **Назначение:** Управление списками пользователей.

- **UsersListMember**
  - **Таблица:** `users_list_members`
  - **Назначение:** Хранение отслеживаемых пользователей.

- **UsersListSubscribtion**
  - **Таблица:** `users_list_subscribtions`
  - **Назначение:** Хранение подписчиков списков.

- **UserSubscribtion**
  - **Таблица:** `user_subscribtions`
  - **Назначение:** Хранение подписчиков пользователей.
